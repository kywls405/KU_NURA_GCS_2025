{"ast":null,"code":"import _toConsumableArray from\"C:/Users/yati0/NURA_GCS/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"C:/Users/yati0/NURA_GCS/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState,useRef}from\"react\";import{socket,serIsOn}from\"./socket\";import Navball from\"./navball\";import NavInfo from\"./navInfo\";import Map from\"./map3d\";import CFG from\"./cfg_window\";import\"./App.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _imu;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),imu=_useState2[0],imuSet=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),gps=_useState4[0],gpsSet=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),coord=_useState6[0],coordSet=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),alt=_useState8[0],altSet=_useState8[1];var timeRef=useRef({imu:-1,gps:-1});var serialInputRef=useRef();var serialInputWidth=window.innerWidth>660?window.innerWidth-360:300;useEffect(function(){var set_imu=function set_imu(data){if(Array.isArray(data.imu)&&data.imu.length>0){imuSet(function(imu){return[].concat(_toConsumableArray(imu),_toConsumableArray(data.imu));});timeRef.current.imu=data.time;}};var set_gps=function set_gps(data){if(Array.isArray(data.gps)&&data.gps.length>0){gpsSet([].concat(_toConsumableArray(gps),_toConsumableArray(data.gps)));var coordList=[];var altList=[];data.gps.map(function(value){if(value.lon===0.0&&value.lat===0.0){// do nothing\n}else{coordList.push([value.lon,value.lat]);altList.push(value.height);}});coordSet(function(coord){return[].concat(_toConsumableArray(coord),coordList);});altSet(function(alt){return[].concat(_toConsumableArray(alt),altList);});timeRef.current.gps=data.time;}};socket.on(\"here_are_your_imu\",set_imu);socket.on(\"here_are_your_gps\",set_gps);var serialAck=function serialAck(data){console.log(\"시리얼을 통해 성공적으로 전송됨: %s\",data);};socket.on(\"serialAck\",serialAck);var imuInt=setInterval(function(){if(serIsOn){socket.emit(\"give_me_imu\",timeRef.current.imu);}},15);var gpsInt=setInterval(function(){if(serIsOn){socket.emit(\"give_me_gps\",timeRef.current.gps);}},30);return function(){socket.off(\"here_are_your_imu\",set_imu);socket.off(\"here_are_your_gps\",set_gps);clearInterval(imuInt);clearInterval(gpsInt);};},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(CFG,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"nav-info\",children:[/*#__PURE__*/_jsx(Navball,{euler:(_imu=imu[imu.length-1])===null||_imu===void 0?void 0:_imu.euler}),/*#__PURE__*/_jsx(NavInfo,{imu:imu,gps:gps})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"map\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"serial-input\",style:{height:\"30px\",marginBottom:\"10px\"},children:[/*#__PURE__*/_jsx(\"input\",{ref:serialInputRef,style:{width:\"500px\",height:\"100%\",float:\"left\"},type:\"text\",placeholder:\"시리얼로 전송할 값 입력\"}),/*#__PURE__*/_jsx(\"button\",{style:{width:\"70px\",height:\"100%\",float:\"left\"},onClick:function onClick(){if(serialInputRef.current.value){socket.emit(\"serialInput\",serialInputRef.current.value);console.log(\"값 '%s'가 전송됨\",serialInputRef.current.value);}else{console.log(\"input에 값이 없음\");}},children:\"\\uC804\\uC1A1\"})]}),/*#__PURE__*/_jsx(Map,{coord:coord,alt:alt})]})]});}export default App;","map":{"version":3,"names":["useEffect","useState","useRef","socket","serIsOn","Navball","NavInfo","Map","CFG","jsx","_jsx","jsxs","_jsxs","App","_imu","_useState","_useState2","_slicedToArray","imu","imuSet","_useState3","_useState4","gps","gpsSet","_useState5","_useState6","coord","coordSet","_useState7","_useState8","alt","altSet","timeRef","serialInputRef","serialInputWidth","window","innerWidth","set_imu","data","Array","isArray","length","concat","_toConsumableArray","current","time","set_gps","coordList","altList","map","value","lon","lat","push","height","on","serialAck","console","log","imuInt","setInterval","emit","gpsInt","off","clearInterval","className","children","euler","style","marginBottom","ref","width","float","type","placeholder","onClick"],"sources":["C:/Users/yati0/NURA_GCS/src/App.js"],"sourcesContent":["import { useEffect, useState, useRef } from \"react\";\r\n\r\nimport { socket, serIsOn } from \"./socket\";\r\n\r\nimport Navball from \"./navball\";\r\nimport NavInfo from \"./navInfo\";\r\nimport Map from \"./map3d\";\r\nimport CFG from \"./cfg_window\";\r\n\r\nimport \"./App.css\";\r\n\r\nfunction App() {\r\n  const [imu, imuSet] = useState([]);\r\n  const [gps, gpsSet] = useState([]);\r\n  const [coord, coordSet] = useState([]);\r\n  const [alt, altSet] = useState([]);\r\n  const timeRef = useRef({ imu: -1, gps: -1 });\r\n\r\n  const serialInputRef = useRef();\r\n  const serialInputWidth =\r\n    window.innerWidth > 660 ? window.innerWidth - 360 : 300;\r\n\r\n  useEffect(() => {\r\n    const set_imu = (data) => {\r\n      if (Array.isArray(data.imu) && data.imu.length > 0) {\r\n        imuSet((imu) => [...imu, ...data.imu]);\r\n        timeRef.current.imu = data.time;\r\n      }\r\n    };\r\n    const set_gps = (data) => {\r\n      if (Array.isArray(data.gps) && data.gps.length > 0) {\r\n        gpsSet([...gps, ...data.gps]);\r\n\r\n        let coordList = [];\r\n        let altList = [];\r\n        data.gps.map((value) => {\r\n          if (value.lon === 0.0 && value.lat === 0.0) {\r\n            // do nothing\r\n          } else {\r\n            coordList.push([value.lon, value.lat]);\r\n            altList.push(value.height);\r\n          }\r\n        });\r\n        coordSet((coord) => [...coord, ...coordList]);\r\n        altSet((alt) => [...alt, ...altList]);\r\n        timeRef.current.gps = data.time;\r\n      }\r\n    };\r\n\r\n    socket.on(\"here_are_your_imu\", set_imu);\r\n    socket.on(\"here_are_your_gps\", set_gps);\r\n\r\n    const serialAck = (data) => {\r\n      console.log(\"시리얼을 통해 성공적으로 전송됨: %s\", data);\r\n    };\r\n\r\n    socket.on(\"serialAck\", serialAck);\r\n\r\n    let imuInt = setInterval(() => {\r\n      if (serIsOn) {\r\n        socket.emit(\"give_me_imu\", timeRef.current.imu);\r\n      }\r\n    }, 15);\r\n    let gpsInt = setInterval(() => {\r\n      if (serIsOn) {\r\n        socket.emit(\"give_me_gps\", timeRef.current.gps);\r\n      }\r\n    }, 30);\r\n\r\n    return () => {\r\n      socket.off(\"here_are_your_imu\", set_imu);\r\n      socket.off(\"here_are_your_gps\", set_gps);\r\n\r\n      clearInterval(imuInt);\r\n      clearInterval(gpsInt);\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <CFG />\r\n      <div className=\"nav-info\">\r\n        <Navball euler={imu[imu.length - 1]?.euler} />\r\n        <NavInfo imu={imu} gps={gps} />\r\n      </div>\r\n      <div className=\"map\">\r\n        <div\r\n          className=\"serial-input\"\r\n          style={{\r\n            height: \"30px\",\r\n            marginBottom: \"10px\",\r\n          }}\r\n        >\r\n          <input\r\n            ref={serialInputRef}\r\n            style={{\r\n              width: \"500px\",\r\n              height: \"100%\",\r\n              float: \"left\",\r\n            }}\r\n            type=\"text\"\r\n            placeholder={\"시리얼로 전송할 값 입력\"}\r\n          ></input>\r\n          <button\r\n            style={{\r\n              width: \"70px\",\r\n              height: \"100%\",\r\n              float: \"left\",\r\n            }}\r\n            onClick={() => {\r\n              if (serialInputRef.current.value) {\r\n                socket.emit(\"serialInput\", serialInputRef.current.value);\r\n                console.log(\"값 '%s'가 전송됨\", serialInputRef.current.value);\r\n              } else {\r\n                console.log(\"input에 값이 없음\");\r\n              }\r\n            }}\r\n          >\r\n            전송\r\n          </button>\r\n        </div>\r\n        <Map coord={coord} alt={alt} />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}